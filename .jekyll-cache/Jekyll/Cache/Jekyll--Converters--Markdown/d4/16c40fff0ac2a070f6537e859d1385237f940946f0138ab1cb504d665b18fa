I"[<h1 id="f-the-people-who-do-not-add-newline-at-end-of-file">F*** the people, who do not add Newline at End of File</h1>

<p>Nghe có vẻ cứt bò, tuy nhiên sự thật là việc không add một trong trống ở cuối file thực sự là một tội ác</p>

<h1 id="no-newline-at-end-of-file">No Newline at End of File</h1>

<p>Bạn đã bao giờ nhìn thấy dòng chữ ở git</p>

<p><img src="https://github.com/wingadium1/wingadium1.github.io/raw/master/img/git_diff_no_line_eof.png" alt="alt text" /></p>

<p>hay ở vim</p>

<p><img src="https://github.com/wingadium1/wingadium1.github.io/raw/master/img/vim_no_line_eol.png" alt="alt text" /></p>

<p>Ờ thế tại sao git lại báo thế, nó đến từ một quyết định trong quá khứ của Unix</p>

<blockquote>
  <p>Một tệp nguồn không trống sẽ kết thúc bằng một ký tự dòng mới, không được đặt ngay trước ký tự dấu gạch chéo ngược (backslash).</p>

  <p>Vì đây là mệnh đề, nên chúng ta sẽ kiểm tra việc vi phạm quy tắc</p>
</blockquote>

<p>Vì vậy, nó chỉ ra rằng, theo POSIX, mọi tệp văn bản (bao gồm các tệp nguồn Ruby và JavaScript) phải kết thúc bằng một ký tự <strong><em>\n</em></strong>, hoặc mới newline (không phải là một dòng mới). Điều này đóng vai trò là eol, hoặc kết thúc của dòng nhân vật. Nó là một dòng <strong><em>Terminator</em></strong>.</p>

<p>Bây giờ thì gần như mọi chương trình text editor đều hỗ trợ việc tự động thêm 1 dòng trống vào cuối file, ví dụ:</p>
<ul>
  <li>vim: mặc định rồi, nên là cứ để nó mặc định thôi</li>
  <li>VSCode: dùng setting <strong>Files: Insert Final Newline</strong></li>
  <li>Sublime: dùng setting <strong>ensure_newline_at_eof_on_save</strong></li>
</ul>

<p>Tóm lại là anh em nên thêm 1 dòng vào cuối file code nếu chưa có thì hãy sửa như sau:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git ls-files <span class="nt">-z</span> | <span class="k">while </span><span class="nv">IFS</span><span class="o">=</span> <span class="nb">read</span> <span class="nt">-rd</span> <span class="s1">''</span> f<span class="p">;</span> <span class="k">do </span><span class="nb">tail</span> <span class="nt">-c1</span> &lt; <span class="s2">"</span><span class="nv">$f</span><span class="s2">"</span> | <span class="nb">read</span> <span class="nt">-r</span> _ <span class="o">||</span> <span class="nb">echo</span> <span class="o">&gt;&gt;</span> <span class="s2">"</span><span class="nv">$f</span><span class="s2">"</span><span class="p">;</span> <span class="k">done</span>
</code></pre></div></div>

<p>ref: https://unix.stackexchange.com/questions/31947/how-to-add-a-newline-to-the-end-of-a-file</p>
:ET